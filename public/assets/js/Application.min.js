!function e(n,t,o){function r(s,c){if(!t[s]){if(!n[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var l=t[s]={exports:{}};n[s][0].call(l.exports,function(e){var t=n[s][1][e];return r(t?t:e)},l,l.exports,e,n,t,o)}return t[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,n,t){"use strict";n.exports=function(e){e.constant("API",{url:"http://merijncelie.nl:3000/api",key:"EP3qxDM91vOA4FC3i0ERa7SE72le8L32",clientId:"WebV1",clientSecret:"Web123456"}),e.factory("TestService",function(){return{}}),e.factory("UserService",function(e,n){return{login:function(t,o){return e.post(n.url+"/oauth/token",{username:t,password:o,grant_type:"password",client_id:n.clientId,client_secret:n.clientSecret})},getUserInfo:function(){return e.get(n.url+"/users/@me")},updateUser:function(t){return e.put(n.url+"/users/"+t._id,{email:t.emai,firstName:t.firstName,middleName:t.middleName,surName:t.surName,street:t.street,houseNumber:t.houseNumber,city:t.city,zipCode:t.zipCode,phone1:t.phone1,phone2:t.phone2,organization:t.organization,roles:t.roles})}}})}},{}],2:[function(e,n,t){n.exports=function(n){var t=angular.module("app.api",[]);return e("./Api.js")(t),t}},{"./Api.js":1}],3:[function(e,n,t){var o=angular.module("app",["ngRoute","app.api","app.authentication","app.user"]);o.config(function(e){e.interceptors.push("TokenInterceptor")}).config(function(e){e.startSymbol("[["),e.endSymbol("]]")});e("./Authentication/_index")(o),e("./User/_index")(o),e("./Api/_index")(o);o.run(function(e,n,t,o){e.$on("$routeChangeStart",function(e,r,i){null==r||null==r.access||!r.access.requiredAuthentication||o.isAuthenticated||t.sessionStorage.token||n.path("/auth/login")})}),o.config(["$locationProvider","$routeProvider",function(e,n){n.when("/auth/login",{templateUrl:"partials/login.html",controller:"AuthenticationController"}).when("/profile/edit",{templateUrl:"partials/user/edit.html",controller:"UserController"}).otherwise({redirectTo:"/"})}])},{"./Api/_index":2,"./Authentication/_index":8,"./User/_index":13}],4:[function(e,n,t){n.exports=function(e){e.controller("AuthenticationController",["$scope","$location","$window","UserService","AuthenticationService",function(e,n,t,o,r){e.signIn=function(e,i){null!=e&&null!=i&&o.login(e,i).success(function(e){r.isAuthenticated=!0,t.sessionStorage.access_token=e.access_token,t.sessionStorage.refresh_token=e.refresh_token,n.path("/profile/edit")}).error(function(e,n){console.log(e),console.log(n)})}}])}},{}],5:[function(e,n,t){n.exports=function(n){e("./AuthenticationController.js")(n)}},{"./AuthenticationController.js":4}],6:[function(e,n,t){n.exports=function(e){e.factory("AuthenticationService",function(){var e={isAuthenticated:!1,isAdmin:!1};return e}),e.factory("TokenInterceptor",["$q","$window","$location","API","AuthenticationService",function(e,n,t,o,r){return{request:function(e){return e.headers=e.headers||{},n.sessionStorage.refresh_token&&(console.log("authentication header"),e.headers.Authorization="Bearer "+n.sessionStorage.access_token,r.isAuthenticated=!0),e.headers["x-key"]=o.key,e},requestError:function(n){return e.reject(n)},response:function(t){return null!=t&&200==t.status&&n.sessionStorage.token&&!r.isAuthenticated&&(r.isAuthenticated=!0),t||e.when(t)},responseError:function(o){return null!=o&&401===o.status&&(n.sessionStorage.token||r.isAuthenticated)&&(delete n.sessionStorage.token,r.isAuthenticated=!1,t.path("/login")),e.reject(o)}}}])}},{}],7:[function(e,n,t){n.exports=function(n){e("./Authentication.js")(n)}},{"./Authentication.js":6}],8:[function(e,n,t){n.exports=function(n){var t=angular.module("app.authentication",["app.api"]);return e("./Controllers/_index.js")(t),e("./Services/_index.js")(t),t}},{"./Controllers/_index.js":5,"./Services/_index.js":7}],9:[function(e,n,t){n.exports=function(e){e.controller("UserController",["$scope","$location","$window","UserFactory","UserService","AuthenticationService",function(e,n,t,o,r,i){function s(){e.editmode=!1}function c(){i.isAuthenticated?r.getUserInfo().success(function(n){e.user=n[0]}).error(function(e,n){console.log(e),console.log(n)}):console.log("not authenticated")}e.editmode=!1,e.user={},c(),e.switchToEditmode=function(){e.editmode=!0},e.updateUserInfo=function(){i.isAuthenticated?r.updateUser(e.user).success(function(e){s()}).error(function(e,n){console.log(e),console.log(n)}):console.log("not authenticated")}}])}},{}],10:[function(e,n,t){n.exports=function(n){e("./UserController.js")(n)}},{"./UserController.js":9}],11:[function(e,n,t){n.exports=function(e){e.factory("UserFactory",["UserService","AuthenticationService",function(e,n){var t={};return t.user={},t.getUser=function(){return console.log("get user"),t.user},t.fillUser=function(){t.user={username:"JoepTest",hashedPassword:"3872822418e1325c97520b1e65aae2137359a2a8",salt:"U3WCVzqIyNLgADHRScp8ncbWMQDgNSbj+dl9ITauhPw=",email:"jjc.vandenbroek@student.avans.nl",firstName:"Joep",middleName:"van den",surName:"Broek",street:"leijzoom",houseNumber:"4",city:"Goirle",_id:"553e5c609f8bdebe785299a7",__v:0,roles:[],organization:[],created:"2015-04-27T15:57:20.123Z"}},t.getUserInfo=function(){n.isAuthenticated?e.getUserInfo().success(function(e){return t.user=e[0],e[0]}).error(function(e,n){console.log(e),console.log(n)}):console.log("not authenticated")},t.updateUserInfo=function(){},t}])}},{}],12:[function(e,n,t){n.exports=function(n){e("./UserService.js")(n)}},{"./UserService.js":11}],13:[function(e,n,t){n.exports=function(n){var t=angular.module("app.user",["app.api"]);return e("./Controllers/_index.js")(t),e("./Services/_index.js")(t),t}},{"./Controllers/_index.js":10,"./Services/_index.js":12}]},{},[3]);